<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Cashier</title>
    <link rel="manifest" href="manifest.json" />
    <script>
        var port = undefined;

        window.addEventListener("message", function(event) {
            if (event.origin !== 'https://rohi1456.github.io') return; // Restrict origin
            port = event.ports[0];
            if (typeof port === 'undefined') {
                console.log('Port not available');
                return;
            }
            console.log('Port established from event');
            port.postMessage(JSON.stringify({"eventName": "ON_PAGE_LOAD", "parameters": {"URL": "https://promo.nj.betmgm.com/en/promo/geolocator/sports?_nativeApp=sportsw&lang=en"}}));
            setupPortListener();
        });

        function setupPortListener() {
            if (port) {
                port.onmessage = function(event) {
                    console.log("[PostMessage1] Got message from app: " + event.data);
                    // Optional: Send a response back to app
                    port.postMessage(JSON.stringify({"eventName": "WEB_RESPONSE", "parameters": {"response": event.data}}));
                };
            }
        }

        function myFunction1() {
            if (!port) {
                console.log('Port not available, requesting channel');
                window.postMessage("REQUEST_CHANNEL", 'https://rohi1456.github.io');
                return;
            }
            port.postMessage(JSON.stringify({"eventName": "ON_PAGE_LOAD1", "parameters": {"URL": "https://promo.nj.betmgm.com/en/promo/geolocator/sports?_nativeApp=sportsw&lang=en"}}));
            setupPortListener(); // Ensure listener is active
        }

        function myFunction2() {
            window.parent.postMessage(JSON.stringify({"eventName": "ON_PAGE_LOAD2", "parameters": {"URL": "https://promo.nj.betmgm.com/en/promo/geolocator/sports?_nativeApp=sportsw&lang=en"}}), 'https://rohi1456.github.io');
        }

        function myFunction3() {
            window.postMessage(JSON.stringify({"eventName": "ON_PAGE_LOAD3", "parameters": {"URL": "https://promo.nj.betmgm.com/en/promo/geolocator/sports?_nativeApp=sportsw&lang=en"}}), 'https://rohi1456.github.io');
        }
    </script>
</head>
<body>
    <button onclick="myFunction1()">Click me 1</button>
    <button onclick="myFunction2()">Click me 2</button>
    <button onclick="myFunction3()">Click me 3</button>
    <input type="hidden" id="portValue" name="portValue" value="34657" />
</body>
</html>

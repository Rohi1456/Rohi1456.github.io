<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Cashier</title>
    <link rel="manifest" href="manifest.json" />
    <script>
        var port = undefined;
        var isPortReady = false;

        window.addEventListener("message", function (event) {
            port = event.ports[0];
            if (typeof port === 'undefined') return;

            isPortReady = true;

            // This is the initial message from the TWA.
            // You can optionally reply to the TWA to acknowledge.
            port.postMessage(JSON.stringify({"eventName": "ON_PAGE_LOAD"}));

            port.onmessage = function(event) {
                console.log("[PostMessage1] Got message: " + event.data);
            };
        });

        function myFunction1() {
            if (isPortReady) {
                port.postMessage(JSON.stringify({"eventName": "ON_BUTTON_CLICK"}));
            } else {
                console.error("Port is not ready. Cannot send message.");
            }
        }
    </script>
</head>
<body>
    <button onclick="myFunction1()">Click me</button>
</body>
</html>
